- case: pointset_type_promotion
  parametrized:
    # Test that vtk type is not a subtype of pyvista type
    - plugin: ''
      required_type: _PointSet
      object_type: vtkPointSet
      output: 'main:5: error: Argument 1 to "foo" has incompatible type "vtkPointSet"; expected "_PointSet"  [arg-type]'

    # Same as above, but use the plugin.
    - plugin: pyvista_mypy_plugin
      required_type: _PointSet
      object_type: vtkPointSet
      output: 'main:5: error: Argument 1 to "foo" has incompatible type "vtkPointSet"; expected "_PointSet"  [arg-type]'

    # Without the plugin, pyvista type is not a subtype of vtk type
    - plugin: ''
      required_type: vtkPointSet
      object_type: _PointSet
      output: 'main:5: error: Argument 1 to "foo" has incompatible type "_PointSet"; expected "vtkPointSet"  [arg-type]'

    # With the plugin, pyvista type is considered a subtype of vtk type
    - plugin: pyvista_mypy_plugin
      required_type: vtkPointSet
      object_type: _PointSet
      output: ''

    # Check pyvista type works with parent of vtk type
    - plugin: pyvista_mypy_plugin
      required_type: vtkDataSet
      object_type: _PointSet
      output: ''

  mypy_config: |
    plugins = {{ plugin }}
    no_incremental = True
  main: |
    from pyvista.core.pointset import _PointSet
    from vtkmodules.vtkCommonDataModel import vtkPointSet, vtkDataSet
    def foo(x: {{ required_type }}): ...
    y: {{ object_type }}
    foo(y)
  out: |
    {{ output }}
